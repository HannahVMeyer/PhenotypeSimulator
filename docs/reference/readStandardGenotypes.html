<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read genotypes from file. — readStandardGenotypes • PhenotypeSimulator</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Read genotypes from file. — readStandardGenotypes" />
<meta property="og:description" content="readStandardGenotypes can read genotypes from a number of input
formats for standard GWAS (binary plink, snptest, bimbam, gemma) or
simulation software (binary plink, hapgen2, genome). Alternatively, simple
text files (with specified delimiter) can be read. For more information on
the different file formats see External genotype software and formats." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhenotypeSimulator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/PhenotypeSimulator.html">Step-by-step phenotype simulation</a>
    </li>
    <li>
      <a href="../articles/Simulation-and-LinearModel.html">Application of PhenotypeSimulator for a power analysis study</a>
    </li>
    <li>
      <a href="../articles/Sample-scripts-external-genotype-simulation.html">Genotype simulation supported by PhenotypeSimulator</a>
    </li>
    <li>
      <a href="../articles/SimulationBasedOnExampleData.html">Phenotype simulation based on an example dataset</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-code"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/HannahVMeyer/PhenotypeSimulator">
    <span class="fas fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read genotypes from file.</h1>
    <small class="dont-index">Source: <a href='https://github.com/HannahVMeyer/PhenotypeSimulator/blob/master/R/genotypeFunctions.R'><code>R/genotypeFunctions.R</code></a></small>
    <div class="hidden name"><code>readStandardGenotypes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>readStandardGenotypes can read genotypes from a number of input
formats for standard GWAS (binary plink, snptest, bimbam, gemma) or
simulation software (binary plink, hapgen2, genome). Alternatively, simple
text files (with specified delimiter) can be read. For more information on
the different file formats see <em>External genotype software and formats</em>.</p>
    </div>

    <pre class="usage"><span class='fu'>readStandardGenotypes</span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>filename</span>, format <span class='op'>=</span> <span class='cn'>NULL</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  sampleID <span class='op'>=</span> <span class='st'>"ID_"</span>, snpID <span class='op'>=</span> <span class='st'>"SNP_"</span>, delimiter <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>Number [integer] of samples to simulate.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>path/to/genotypefile [string] in plink, oxgen
(impute2/snptest/hapgen2), genome, bimbam or [delimiter]-delimited format (
for format information see <em>External genotype software and formats</em>).</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>Name [string] of genotype file format. Options are: "plink",
"oxgen", "genome", "bimbam" or "delim".</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>[boolean] If TRUE, progress info is printed to standard out.</p></td>
    </tr>
    <tr>
      <th>sampleID</th>
      <td><p>Prefix [string] for naming samples (will be followed by
sample number from 1 to N when constructing id_samples).</p></td>
    </tr>
    <tr>
      <th>snpID</th>
      <td><p>Prefix [string] for naming SNPs (will be followed by SNP number
from 1 to NrSNP when constructing id_snps).</p></td>
    </tr>
    <tr>
      <th>delimiter</th>
      <td><p>Field separator [string] of genotype file when
format == "delim".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Named list of [NrSamples X NrSNPs] genotypes (genotypes), their
[NrSNPs] SNP IDs (id_snps), their [NrSamples] sample IDs (id_samples) and
format-specific additional files (such as format-specific genotypes encoding
or sample information; might be used for output writing).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The file formats and software formates supported are described
below. For large external genotypes, consider the option to only read
randomly selected, causal SNPs into memory via <a href='getCausalSNPs.html'>getCausalSNPs</a>.</p>
    <h2 class="hasAnchor" id="external-genotype-software-and-formats"><a class="anchor" href="#external-genotype-software-and-formats"></a>External genotype software and formats</h2>

    

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Formats:</h3>

<ul>
<li><p>PLINK: consists of three files: .bed, .bim and .fam. When specifying
the filepath, only the core of the name without the ending should be
specified (i.e. for geno.bed, geno.bim and geno.fam, geno should be
specified). When reading data from plink files, the absolute path to the
plink-format file has to be provided, tilde expansion not provided.
From <a href='https://www.cog-genomics.org/plink/1.9/formats'>https://www.cog-genomics.org/plink/1.9/formats</a>:  The .bed
files contain the  primary representation of genotype calls at biallelic
variants in a binary format. The .bim is a text file with no header
line, and one line  per variant with the following six fields: i) Chromosome
code (either an integer, or 'X'/'Y'/'XY'/'MT'; '0' indicates unknown) or
name, ii) Variant identifier, iii) Position in morgans or centimorgans (safe
to use dummy value of '0'), iv) Base-pair coordinate (normally 1-based, but
0 ok; limited to 231-2), v) Allele 1 (corresponding to clear bits in .bed;
usually minor), vi) Allele 2 (corresponding to set bits in .bed; usually
major). The .fam file is a text file with no header line, and one line per
sample with the following six fields: i) Family ID ('FID'), ii), Within-
family ID ('IID'; cannot be '0'), iii) Within-family ID of father ('0' if
father isn't in dataset, iv) within-family ID of mother ('0' if mother isn't
in dataset), v) sex code ('1' = male, '2' = female, '0' = unknown), vi)
Phenotype value ('1' = control, '2' = case, '-9'/'0'/non-numeric = missing
data if case/control)</p></li>
<li><p>oxgen: consists of two files: the space-separated genotype file ending
in .gen and the space-separated sample file ending in .sample. When
specifying the filepath, only the core of the name without the ending should
be specified (i.e. for geno.gen and geno.sample, geno should be specified).
From
 <a href='https://www.well.ox.ac.uk/~gav/snptest/#input_file_formats'>https://www.well.ox.ac.uk/~gav/snptest/#input_file_formats</a>:
The genotype file stores data on a one-line-per-SNP format. The first five
entries of each line should be the SNP ID, RS ID of the SNP, base-pair
position of the SNP, the allele coded A and the allele coded B. The SNP ID
can be used to denote the chromosome number of each SNP. The next three
numbers on the line should be the probabilities of the three genotypes AA,
AB and BB at the SNP for the first individual in the cohort. The next three
numbers should be the genotype probabilities for the second individual in the
cohort. The next three numbers are for the third individual and so on. The
order of individuals in the genotype file should match the order of the
individuals in the sample file. The sample file has three parts (a) a header
line detailing the names of the columns in the file, (b) a line detailing the
types of variables stored in each column, and (c) a line for each individual
detailing the information for that individual. For more information on the
sample file visit the above url or see <a href='writeStandardOutput.html'>writeStandardOutput</a>.</p></li>
<li><p>genome: The entire output of genome can be saved via `genome -options &gt;
outputfile`. The /path/to/outputfile should be provided and this function
extracts the relevant genotype information from this output file.
<a href='http://csg.sph.umich.edu/liang/genome'>http://csg.sph.umich.edu/liang/genome</a></p></li>
<li><p>bimbam: Mean genotype file format of bimbam which is a single, comma-
separated file, without information on individuals. From
<a href='http://www.haplotype.org/bimbam.html'>http://www.haplotype.org/bimbam.html</a>: the first column of the mean
genotype files is the SNP ID, the second and third columns are allele types
with minor allele first. The remaining columns are the mean genotypes of
different individuals – numbers between 0 and 2 that represents the
(posterior) mean genotype, or dosage of the minor allele.</p></li>
<li><p>delim: a [delimter]-delimited file of [NrSNPs x NrSamples] genotypes
with the snpIDs in the first column and the sampleIDs in the first row and
genotypes encoded as numbers between 0 and 2 representing the (posterior)
mean genotype, or dosage of the minor allele. Can be user-genotypes or
genotypes simulated with foward-time algorithms such as simupop
(<a href='http://simupop.sourceforge.net/Main/HomePage'>http://simupop.sourceforge.net/Main/HomePage</a>) or MetaSim
(<a href='project.org/web/packages/rmetasim/vignettes/CreatingLandscapes.html'>project.org/web/packages/rmetasim/vignettes/CreatingLandscapes.html</a>),
that allow for user-specified output formats.</p></li>
</ul>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Genotype simulation characteristics:</h3>

<ul>
<li><p>PLINK: simple, bi-allelelic genotypes without LD structure, details can
be found at <a href='https://www.cog-genomics.org/plink/1.9/input#simulate'>https://www.cog-genomics.org/plink/1.9/input#simulate</a>.</p></li>
<li><p>Hapgen2: resampling-based genotype simulation, details can be found at
<a href='http://mathgen.stats.ox.ac.uk/genetics_software/hapgen/hapgen2.html'>http://mathgen.stats.ox.ac.uk/genetics_software/hapgen/hapgen2.html</a>.</p></li>
<li><p>Genome: coalescent-based genotype simulation, details can be found at
<a href='http://csg.sph.umich.edu/liang/genome/GENOME-manual.pdf'>http://csg.sph.umich.edu/liang/genome/GENOME-manual.pdf</a>.</p></li>
</ul><p>Examples on how to call these genotype simulation tools can be found in the
vignette <em>sample-scripts-external-genotype-simulation</em>.</p>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Genome format</span>
<span class='va'>filename_genome</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/genotypes/genome/"</span>,
<span class='st'>"genotypes_genome.txt"</span>,
package <span class='op'>=</span> <span class='st'>"PhenotypeSimulator"</span><span class='op'>)</span>
<span class='va'>data_genome</span> <span class='op'>&lt;-</span> <span class='fu'>readStandardGenotypes</span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>100</span>, <span class='va'>filename_genome</span>, format <span class='op'>=</span><span class='st'>"genome"</span><span class='op'>)</span>

<span class='va'>filename_hapgen</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/genotypes/hapgen/"</span>,
<span class='st'>"genotypes_hapgen.controls.gen"</span>,
package <span class='op'>=</span> <span class='st'>"PhenotypeSimulator"</span><span class='op'>)</span>
<span class='va'>filename_hapgen</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\.gen"</span>, <span class='st'>""</span>, <span class='va'>filename_hapgen</span><span class='op'>)</span>
<span class='va'>data_hapgen</span> <span class='op'>&lt;-</span> <span class='fu'>readStandardGenotypes</span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>100</span>, <span class='va'>filename_hapgen</span>, format<span class='op'>=</span><span class='st'>'oxgen'</span><span class='op'>)</span>

<span class='va'>filename_plink</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/genotypes/plink/"</span>,
<span class='st'>"genotypes_plink.bed"</span>,
package <span class='op'>=</span> <span class='st'>"PhenotypeSimulator"</span><span class='op'>)</span>
<span class='va'>filename_plink</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\.bed"</span>, <span class='st'>""</span>, <span class='va'>filename_plink</span><span class='op'>)</span>
<span class='va'>data_plink</span> <span class='op'>&lt;-</span> <span class='fu'>readStandardGenotypes</span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>100</span>, filename<span class='op'>=</span><span class='va'>filename_plink</span>,
format<span class='op'>=</span><span class='st'>"plink"</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


