<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Draw random SNPs from genotypes. — getCausalSNPs • PhenotypeSimulator</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Draw random SNPs from genotypes. — getCausalSNPs" />
<meta property="og:description" content="Draw random SNPs from genotypes provided or external genotype files.
When drawing from external genotype files, only lines of randomly
chosen SNPs are read, which is recommended for large genotype files. See
details for more information. The latter option currently supports file in
simple delim-formats (with specified delimiter and optional number of fields
to skip) and the bimbam and the oxgen format." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhenotypeSimulator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/PhenotypeSimulator.html">Step-by-step phenotype simulation</a>
    </li>
    <li>
      <a href="../articles/Simulation-and-LinearModel.html">Application of PhenotypeSimulator for a power analysis study</a>
    </li>
    <li>
      <a href="../articles/Sample-scripts-external-genotype-simulation.html">Genotype simulation supported by PhenotypeSimulator</a>
    </li>
    <li>
      <a href="../articles/SimulationBasedOnExampleData.html">Phenotype simulation based on an example dataset</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-code"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/HannahVMeyer/PhenotypeSimulator">
    <span class="fas fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Draw random SNPs from genotypes.</h1>
    <small class="dont-index">Source: <a href='https://github.com/HannahVMeyer/PhenotypeSimulator/blob/master/R/genotypeFunctions.R'><code>R/genotypeFunctions.R</code></a></small>
    <div class="hidden name"><code>getCausalSNPs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draw random SNPs from genotypes provided or external genotype files.
When drawing from external genotype files, only lines of randomly
chosen SNPs are read, which is recommended for large genotype files. See
details for more information. The latter option currently supports file in
simple delim-formats (with specified delimiter and optional number of fields
to skip) and the bimbam and the oxgen format.</p>
    </div>

    <pre class="usage"><span class='fu'>getCausalSNPs</span><span class='op'>(</span><span class='va'>N</span>, NrCausalSNPs <span class='op'>=</span> <span class='fl'>20</span>, genotypes <span class='op'>=</span> <span class='cn'>NULL</span>, chr <span class='op'>=</span> <span class='cn'>NULL</span>,
  NrSNPsOnChromosome <span class='op'>=</span> <span class='cn'>NULL</span>, NrChrCausal <span class='op'>=</span> <span class='cn'>NULL</span>,
  genoFilePrefix <span class='op'>=</span> <span class='cn'>NULL</span>, genoFileSuffix <span class='op'>=</span> <span class='cn'>NULL</span>, format <span class='op'>=</span> <span class='st'>"delim"</span>,
  delimiter <span class='op'>=</span> <span class='st'>","</span>, header <span class='op'>=</span> <span class='cn'>FALSE</span>, skipFields <span class='op'>=</span> <span class='cn'>NULL</span>,
  probabilities <span class='op'>=</span> <span class='cn'>FALSE</span>, sampleID <span class='op'>=</span> <span class='st'>"ID_"</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>Number [integer] of samples to simulate.</p></td>
    </tr>
    <tr>
      <th>NrCausalSNPs</th>
      <td><p>Number [integer] of SNPs to chose at random.</p></td>
    </tr>
    <tr>
      <th>genotypes</th>
      <td><p>[NrSamples x totalNrSNPs] Matrix of genotypes [integer]/
[double].</p></td>
    </tr>
    <tr>
      <th>chr</th>
      <td><p>Vector of chromosome(s) [integer] to chose NrCausalSNPs from; only
used when external genotype data is provided i.e. !is.null(genoFilePrefix).</p></td>
    </tr>
    <tr>
      <th>NrSNPsOnChromosome</th>
      <td><p>Vector of number(s) of SNPs [integer] per entry in
chr (see above); has to be the same length as chr. If not provided, number of
SNPS in file will be determined from line count (which can be slow for large
files); (optional) header lines will be ignored, so accurate number of SNPs
not lines in file should be specified.</p></td>
    </tr>
    <tr>
      <th>NrChrCausal</th>
      <td><p>Number [integer] of causal chromosomes to sample
NrCausalSNPs from (as opposed to the actual chromosomes to chose from via chr
); only used when external genotype data is provided i.e.
!is.null(genoFilePrefix).</p></td>
    </tr>
    <tr>
      <th>genoFilePrefix</th>
      <td><p>full path/to/chromosome-wise-genotype-file-ending-
before-"chrChromosomeNumber" (no '~' expansion!) [string].</p></td>
    </tr>
    <tr>
      <th>genoFileSuffix</th>
      <td><p>[string] Following chromosome number including
.fileformat (e.g. ".csv"); File described by genoFilePrefix-genoFileSuffix
has to be a text format i.e. comma/tab/space separated.</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>Name [string] of genotype file format. Options are:
"oxgen", "bimbam" or "delim". See <a href='readStandardGenotypes.html'>readStandardGenotypes</a> for details.</p></td>
    </tr>
    <tr>
      <th>delimiter</th>
      <td><p>Field separator [string] of genotypefile or
genoFilePrefix-genoFileSuffix file if format == 'delim'.</p></td>
    </tr>
    <tr>
      <th>header</th>
      <td><p>[logical] Can be set to indicate if
genoFilePrefix-genoFileSuffix file has a header for format == 'delim'. 
See details.</p></td>
    </tr>
    <tr>
      <th>skipFields</th>
      <td><p>Number [integer] of fields (columns) to skip in
genoFilePrefix-genoFileSuffix file if format == 'delim'. See details.</p></td>
    </tr>
    <tr>
      <th>probabilities</th>
      <td><p>[boolean]. If set to TRUE, the genotypes in the files
described by genoFilePrefix-genoFileSuffix are provided as triplets of
probabilities (p(AA), p(Aa), p(aa)) and are converted into their expected
genotype frequencies by 0*p(AA) + p(Aa) + 2p(aa) via <a href='probGen2expGen.html'>probGen2expGen</a>.</p></td>
    </tr>
    <tr>
      <th>sampleID</th>
      <td><p>Prefix [string] for naming samples (will be followed by
sample number from 1 to N when constructing id_samples)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>[boolean] If TRUE, progress info is printed to standard out</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>[N x NrCausalSNPs] Matrix of randomly drawn genotypes [integer]/
[double]</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In order to chose SNPs from external genotype files without reading
them into memory, genotypes for each chromosome need to be accesible as
[SNPs x samples] in a separate file, containing "chrChromosomenumber" (e.g
chr22) in the file name (e.g. /path/to/dir/related_nopopstructure_chr22.csv).
All genotype files need to be saved in the same directory. genoFilePrefix
(/path/to/dir/related_nopopstructure_) and genoFileSuffix (.csv) specify the
strings leading and following the "chrChromosomenumber". If format== delim,
the first column in each file needs to be the SNP_ID, the first row can
either contain sample IDs or the first row of genotypes (specified with
header). Subsequent columns containing additional SNP information can be
skipped by setting skipFields. If format==oxgen or bimbam, files need to be
in the oxgen or bimbam format (see <a href='readStandardGenotypes.html'>readStandardGenotypes</a> for details)
and no additional information about delim, header or skipFields will be
considered.
getCausalSNPs generates a vector of chromosomes from which to sample the
SNPs. For each of the chromosomes, it counts the number of SNPs in the
chromosome file and creates vectors of random numbers ranging
from 1:NrSNPSinFile. Only the lines corresponding to these numbers are then
read into R. The example data provided for chromosome 22 contains genotypes
(50 samples) of the first 500 SNPs on chromosome 22 with a minor allele
frequency of greater than 2<!-- % from the European populations of the the 1000 -->
Genomes project.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='standardiseGenotypes.html'>standardiseGenotypes</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># get causal SNPs from genotypes simulated within PhenotypeSimulator</span>
<span class='va'>geno</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simulateGenotypes.html'>simulateGenotypes</a></span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>10</span>, NrSNP<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Simulate 10 SNPs...</span></div><div class='input'><span class='va'>causalSNPsFromSimulatedGenoStandardised</span> <span class='op'>&lt;-</span> <span class='fu'>getCausalSNPs</span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>10</span>,
NrCausalSNPs<span class='op'>=</span><span class='fl'>10</span>, genotypes<span class='op'>=</span><span class='va'>geno</span><span class='op'>$</span><span class='va'>genotypes</span><span class='op'>)</span>

<span class='co'># Get causal SNPs by sampling lines from large SNP files</span>
<span class='va'>genotypeFile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/genotypes/"</span>,
<span class='st'>"genotypes_chr22.csv"</span>,
package <span class='op'>=</span> <span class='st'>"PhenotypeSimulator"</span><span class='op'>)</span>
<span class='va'>genoFilePrefix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"chr.*"</span>, <span class='st'>""</span>, <span class='va'>genotypeFile</span><span class='op'>)</span>
<span class='va'>genoFileSuffix</span> <span class='op'>&lt;-</span> <span class='st'>".csv"</span>
<span class='va'>causalSNPsFromLines</span> <span class='op'>&lt;-</span> <span class='fu'>getCausalSNPs</span><span class='op'>(</span>N<span class='op'>=</span><span class='fl'>50</span>, NrCausalSNPs<span class='op'>=</span><span class='fl'>10</span>, chr<span class='op'>=</span><span class='fl'>22</span>,
genoFilePrefix<span class='op'>=</span><span class='va'>genoFilePrefix</span>,
genoFileSuffix<span class='op'>=</span><span class='va'>genoFileSuffix</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Draw 10 causal SNPs from 1 chromosomes...</span></div><div class='output co'>#&gt; <span class='message'>Causal chromosomes: 22</span></div><div class='output co'>#&gt; <span class='message'>Get causal SNPs from chromsome-wide SNP files ( /private/var/folders/rc/xlxbh6n92qzbm6dh_qqcd56h0000gq/T/RtmpKT8ktk/temp_libpath125b94774d8ae/PhenotypeSimulator/extdata/genotypes//genotypes_ ...) </span></div><div class='output co'>#&gt; <span class='message'>Get 10 causal SNPs from chromsome 22 ...</span></div><div class='output co'>#&gt; <span class='message'>Count number of SNPs on chromosome 22 ... </span></div><div class='output co'>#&gt; <span class='message'>Sample SNPs on chromosome 22 ...</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hannah Meyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


